<div class="container mt-4">
  <!-- Team Selection -->
  <div class="mb-3">
    <label for="teamSelect" class="form-label">Select Team</label>
    <select id="teamSelect" class="form-select" [(ngModel)]="selectedTeamId" (change)="onTeamSelect()">
      <option value="">-- Choose a Team --</option>
      <option *ngFor="let team of teams" [value]="team.id">{{ team.name }}</option>
    </select>
  </div>

  <!-- Season Selector -->
  <div class="mb-4" *ngIf="availableSeasons.length > 0">
    <label for="seasonSelect" class="form-label">Select Season</label>
    <select id="seasonSelect" class="form-select" [(ngModel)]="selectedSeason" (change)="loadSeasonGames()">
      <option *ngFor="let season of availableSeasons" [value]="season">Season {{ season }}</option>
    </select>
  </div>

  <!-- Schedule Generator -->
  <div class="card mb-4">
    <div class="card-header">
      <h5 class="mb-0">Generate Season Schedule</h5>
    </div>
    <div class="card-body">
      <form (ngSubmit)="generateSchedule()">
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">Season Number</label>
            <input type="number" class="form-control" [(ngModel)]="season" name="season" required min="1" />
          </div>
          <div class="col-md-4">
            <label class="form-label">Season Start Date</label>
            <input type="date" class="form-control" [(ngModel)]="seasonStartDate" name="startDate" required />
          </div>
          <div class="col-md-4">
            <label class="form-label">Season End Date</label>
            <input type="date" class="form-control" [(ngModel)]="seasonEndDate" name="endDate" required />
          </div>
        </div>

        <div class="mt-3">
          <label class="form-label">Game Days</label>
          <div class="btn-group w-100">
            <button type="button" class="btn" 
                    *ngFor="let day of ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']; let i = index"
                    [class.btn-primary]="gameDays[i]"
                    [class.btn-outline-primary]="!gameDays[i]"
                    (click)="gameDays[i] = !gameDays[i]">
              {{ day }}
            </button>
          </div>
        </div>

        <div class="row g-3 mt-2">
          <div class="col-md-3">
            <label class="form-label">Total Games</label>
            <input type="number" class="form-control" [(ngModel)]="totalGames" name="totalGames" required />
          </div>
          <div class="col-md-3">
            <label class="form-label">Division Games</label>
            <input type="number" class="form-control" [(ngModel)]="divisionGames" name="divisionGames" required />
          </div>
          <div class="col-md-3">
            <label class="form-label">Conference Games</label>
            <input type="number" class="form-control" [(ngModel)]="conferenceGames" name="conferenceGames" required />
          </div>
          <div class="col-md-3">
            <label class="form-label">Other Conf. Games</label>
            <input type="number" class="form-control" [(ngModel)]="otherConferenceGames" name="otherConfGames" required />
          </div>
        </div>

        <div class="mt-3">
          <button type="submit" class="btn btn-primary">Generate Schedule</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Calendar View -->
  <div class="card" *ngIf="calendarDays.length > 0">
    <div class="card-header">
      <div class="d-flex justify-content-between align-items-center">
        <h5 class="mb-0">Season {{ selectedSeason }} Calendar</h5>
        <div class="btn-group">
          <button class="btn btn-outline-secondary" (click)="previousMonth()">&lt;</button>
          <button class="btn btn-outline-secondary" disabled>
            {{ currentMonth | date:'MMMM yyyy' }}
          </button>
          <button class="btn btn-outline-secondary" (click)="nextMonth()">&gt;</button>
        </div>
        <div class="legend d-flex gap-3">
          <span><i class="bi bi-circle-fill text-primary"></i> Division</span>
          <span><i class="bi bi-circle-fill text-success"></i> Conference</span>
          <span><i class="bi bi-circle-fill text-info"></i> Inter-Conference</span>
        </div>
      </div>
    </div>
    <div class="card-body">
      <!-- Calendar Header -->
      <div class="row g-0 text-center border-bottom py-2 fw-bold">
        <div class="col">Sun</div>
        <div class="col">Mon</div>
        <div class="col">Tue</div>
        <div class="col">Wed</div>
        <div class="col">Thu</div>
        <div class="col">Fri</div>
        <div class="col">Sat</div>
      </div>

      <!-- Calendar Grid -->
      <div class="calendar-grid">
        <div class="row g-0">
          <ng-container *ngFor="let day of calendarDays; let i = index">
            <!-- Add a new row every 7 days -->
            <div *ngIf="i % 7 === 0 && i !== 0" class="w-100"></div>
            
            <div class="col border p-2" 
                 [class.bg-light]="!isGameDay(day.date)"
                 [class.text-muted]="!day.isCurrentMonth">
              <div class="d-flex justify-content-between align-items-center mb-1">
                <small>{{ day.date | date:'d' }}</small>
              </div>
              <div *ngFor="let game of day.games" class="game-item">
                <span [class.text-primary]="game.tags?.includes('division')"
                      [class.text-success]="game.tags?.includes('conference')"
                      [class.text-info]="game.tags?.includes('interconference')">
                  {{ game.homeTeam }} vs {{ game.awayTeam }}
                </span>
              </div>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </div>
</div>