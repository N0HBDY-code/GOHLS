<div class="container mt-4">
  <!-- View Mode and Filters -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="row g-3">
        <div class="col-md-4">
          <label class="form-label">View Mode</label>
          <select class="form-select" [(ngModel)]="viewMode" (change)="onViewModeChange()">
            <option value="all">All Games</option>
            <option value="team">Single Team</option>
          </select>
        </div>

        <div class="col-md-4" *ngIf="viewMode === 'team'">
          <label for="teamSelect" class="form-label">Select Team</label>
          <select id="teamSelect" class="form-select" [(ngModel)]="selectedTeamId" (change)="onTeamSelect()">
            <option value="">-- Choose a Team --</option>
            <option *ngFor="let team of teams" [value]="team.id">{{ team.name }}</option>
          </select>
        </div>

        <div class="col-md-4">
          <label class="form-label">Season</label>
          <select class="form-select" [(ngModel)]="selectedSeason" (change)="filterGames()">
            <option *ngFor="let season of availableSeasons" [value]="season">Season {{ season }}</option>
          </select>
        </div>

        <div class="col-12">
          <label class="form-label">Filter by Game Type</label>
          <div class="btn-group">
            <button class="btn" [class.btn-primary]="filterTags.includes('division')" 
                    [class.btn-outline-primary]="!filterTags.includes('division')"
                    (click)="toggleTag('division')">Division</button>
            <button class="btn" [class.btn-success]="filterTags.includes('conference')"
                    [class.btn-outline-success]="!filterTags.includes('conference')"
                    (click)="toggleTag('conference')">Conference</button>
            <button class="btn" [class.btn-info]="filterTags.includes('interconference')"
                    [class.btn-outline-info]="!filterTags.includes('interconference')"
                    (click)="toggleTag('interconference')">Inter-Conference</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Schedule Generator -->
  <div class="card mb-4">
    <div class="card-header">
      <h5 class="mb-0">Generate Season Schedule</h5>
    </div>
    <div class="card-body">
      <form (ngSubmit)="generateSchedule()">
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">Season Number</label>
            <input type="number" class="form-control" [(ngModel)]="season" name="season" required min="1" />
          </div>
          <div class="col-md-4">
            <label class="form-label">Season Start Date</label>
            <input type="date" class="form-control" [(ngModel)]="seasonStartDate" name="startDate" required />
          </div>
          <div class="col-md-4">
            <label class="form-label">Season End Date</label>
            <input type="date" class="form-control" [(ngModel)]="seasonEndDate" name="endDate" required />
          </div>
        </div>

        <div class="mt-3">
          <label class="form-label">Game Days</label>
          <div class="btn-group w-100">
            <button type="button" class="btn" 
                    *ngFor="let day of ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']; let i = index"
                    [class.btn-primary]="gameDays[i]"
                    [class.btn-outline-primary]="!gameDays[i]"
                    (click)="gameDays[i] = !gameDays[i]">
              {{ day }}
            </button>
          </div>
        </div>

        <div class="row g-3 mt-2">
          <div class="col-md-3">
            <label class="form-label">Total Games</label>
            <input type="number" class="form-control" [(ngModel)]="totalGames" name="totalGames" required />
          </div>
          <div class="col-md-3">
            <label class="form-label">Division Games</label>
            <input type="number" class="form-control" [(ngModel)]="divisionGames" name="divisionGames" required />
          </div>
          <div class="col-md-3">
            <label class="form-label">Conference Games</label>
            <input type="number" class="form-control" [(ngModel)]="conferenceGames" name="conferenceGames" required />
          </div>
          <div class="col-md-3">
            <label class="form-label">Other Conf. Games</label>
            <input type="number" class="form-control" [(ngModel)]="otherConferenceGames" name="otherConfGames" required />
          </div>
        </div>

        <div class="mt-3">
          <button type="submit" class="btn btn-primary">Generate Schedule</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Calendar View -->
  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <button class="btn btn-sm btn-outline-secondary" (click)="previousMonth()">&lt;</button>
      <div class="btn-group">
        <button class="btn btn-outline-primary" disabled>
          {{ currentMonth | date:'MMMM yyyy' }}
        </button>
      </div>
      <button class="btn btn-sm btn-outline-secondary" (click)="nextMonth()">&gt;</button>
    </div>
    <div class="card-body">
      <!-- Legend -->
      <div class="legend d-flex gap-4 mb-3">
        <span><i class="fas fa-circle text-primary"></i> Division Games</span>
        <span><i class="fas fa-circle text-success"></i> Conference Games</span>
        <span><i class="fas fa-circle text-info"></i> Inter-Conference Games</span>
      </div>

      <!-- Calendar Grid -->
      <div class="row row-cols-7 text-center border-bottom py-2">
        <div class="col">Sun</div>
        <div class="col">Mon</div>
        <div class="col">Tue</div>
        <div class="col">Wed</div>
        <div class="col">Thu</div>
        <div class="col">Fri</div>
        <div class="col">Sat</div>
      </div>

      <div class="row row-cols-7 calendar-grid">
        <ng-container *ngFor="let day of calendarDays">
          <div class="col border p-2" 
               [class.bg-light]="!day.isCurrentMonth"
               [class.bg-white]="day.isCurrentMonth">
            <div class="d-flex justify-content-between align-items-center mb-1">
              <small class="text-muted">{{ day.date | date:'d' }}</small>
            </div>
            <div *ngFor="let game of day.games" class="game-item">
              <span [ngClass]="{
                'text-primary': game.tags?.includes('division'),
                'text-success': game.tags?.includes('conference'),
                'text-info': game.tags?.includes('interconference')
              }">
                {{ game.homeTeam }} vs {{ game.awayTeam }}
              </span>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>